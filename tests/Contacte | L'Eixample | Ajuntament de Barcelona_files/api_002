
define(["jquery-private",geoBCN.baseFiles+"utils"+geoBCN.suffix+".js","jqueryui/button","jqueryui/accordion","jqueryui/autocomplete","jqueryui/datepicker","jqueryui/widget"],function(jQuery,Utils){var log=geoBCN.log4js.getLogger("html");log.addAppender(geoBCN.logAppender);var panellsCerca=[{"id":"gcCoordenades","label":geoBCN.getLabel("panell.perCoordenades").label,"inputs":["COORD"]},{"id":"gcAdreca","label":geoBCN.getLabel("panell.perAdreca").label,"inputs":["ADR","CRU"]},{"id":"gcIdentificador","label":geoBCN.getLabel("panell.perIdentificador").label,"inputs":["ILLA","RC","F1000"]},{"id":"gcDivAdm","label":geoBCN.getLabel("panell.perDivisioAdm").label,"inputs":["DST","BRR","SECC"]},];function InputAutocomplete(opcions){var selectHandlers=[];var esborraHandlers=[];try{function cridaHandlers(handlersArray){inputError.html("");for(var i=0,eventHandler;eventHandler=handlersArray[i];i++){window.setTimeout(function(obj){try{obj.handler(obj.params);}catch(err){log.warn("Error al cridar handler",err);}},5,{handler:eventHandler,params:autoComplete.getValor()});}}
opcions.mostraLabel=opcions.mostraLabel===false?false:true;if(!opcions.esborraTitle)opcions.esborraTitle=geoBCN.getLabel("input.esborrar").label;if(!opcions.desplegarTitle)opcions.desplegarTitle=geoBCN.getLabel("input.desplegar").label;var inputOrig=jQuery("#"+opcions.inputId);inputOrig.wrapAll("<div class=\"frmInput\"></div>").before(opcions.mostraLabel?["<label for=\"",opcions.inputId,"\">",opcions.label,"</label>"].join(""):"").after([(opcions["combobox"]?["<button type=\"BUTTON\" id=\"btns_",opcions.inputId,"\" title=\"",opcions.desplegarTitle,"\" class=\"ngac\"></button>"].join(""):""),"<button type=\"BUTTON\" id=\"btnd_",opcions.inputId,"\" title=\"",opcions.esborraTitle,"\" class=\"ngac\" style=\"display:none\"></button><span id=\"err_",opcions.inputId,"\" class=\"errorInput\"></span>"].join(""));var btnEsborrar=jQuery("#btnd_"+opcions.inputId).button({text:false,icons:{primary:'ui-icon-trash'}});var btnCombo=opcions["combobox"]?jQuery("#btns_"+opcions.inputId).button({text:false,icons:{primary:'ui-icon-triangle-1-s'}}):null;var inputError=jQuery("#err_"+opcions.inputId);var slaves=[];var textTriat="";var codiTriat="";var valorTriat=null;var isOpen=false;var autoComplete={"jqAutocomplete":null,"label":opcions.label,"setText":function(text){textTriat=text;inputOrig.val(text)},"getText":function(){return inputOrig.val();},"setCodi":function(codi){codiTriat=codi;btnEsborrar.fadeIn();},"getCodi":function(){return codiTriat;},"getValor":function(){return valorTriat;},"setValor":function(valor){valorTriat=valor;},"setError":function(error,timeOutError){inputError.html(error);if(timeOutError)window.setTimeout(function(inputError){inputError.setError("");},timeOutError,inputError);},"setPropietats":function(propietats){if(propietats.text)this.setText(propietats.text);if(propietats.codi)this.setCodi(propietats.codi);if(propietats.valor)this.setValor(propietats.valor);},"addEsclau":function(esclau){slaves.push(esclau);},"cerca":function(text){inputOrig.val(text);inputOrig.autocomplete("search",text);},"onSelect":function(handler){selectHandlers.push(handler);},"onEsborra":function(handler){esborraHandlers.push(handler);},"esborra":function(){if(inputOrig.autocomplete("widget").is(":visible")){inputOrig.autocomplete("close");}
for(var i=0,slave;slave=slaves[i];i++){slave.esborra();slave.setError("");}
btnEsborrar.fadeOut();valorTriat=null;textTriat="";codiTriat="";inputOrig.val("");if(opcions.esborrat){window.setTimeout(function(obj){try{obj.handler(obj.params);}catch(err){log.warn("Error al cridar handler d'esborrat",err);}},5,{handler:opcions.esborrat,params:opcions.inputId});}
cridaHandlers(esborraHandlers);}};if(opcions.esborrat)btnEsborrar.click(function(){autoComplete.esborra();});if(btnCombo)btnCombo.click(function(){if(isOpen){inputOrig.autocomplete("close");}else{autoComplete.cerca("");}});if(opcions.master){opcions.master.addEsclau(autoComplete);}
autoComplete.jqAutocomplete=inputOrig.autocomplete({source:opcions.origen,minLength:0,autoFocus:true,search:function(event,ui){setInputLoading(true);codiTriat='';valorTriat='';autoComplete.setError("");if(opcions.master&&opcions.masterRequired){if(!opcions.master.getCodi()){setInputLoading(false);autoComplete.setError(geoBCN.getLabel("input.empleneuMaster").label+opcions.master.label);inputOrig.val("");event.preventDefault();}}},select:function(event,ui){event.preventDefault();for(var i=0,slave;slave=slaves[i];i++){slave.esborra();slave.setError("");}
btnEsborrar.fadeIn();inputOrig.val(ui.item.label);codiTriat=ui.item.value;valorTriat=ui.item;if(opcions.seleccio){window.setTimeout(function(obj){try{obj.handler(obj.event,obj.params);}catch(err){log.warn("Error al cridar handler de selecció",err);}},5,{handler:opcions.seleccio,event:event,params:ui.item.value});}
cridaHandlers(selectHandlers);},response:function(event,ui){setInputLoading(false);if(!ui.content.length){autoComplete.setError(geoBCN.getLabel("error.senseResultats").label);}},focus:function(event,ui){event.preventDefault();},open:function(){jQuery(".ui-autocomplete:visible").addClass('geobcn-candidates-'+this.id.replace('divCercadors_',''));isOpen=true;},close:function(){isOpen=false;codiTriat==='';}});inputOrig.addClass('geobcn-autocomplete').focusout(function(){if(codiTriat===''||inputError.html().length>0||valorTriat.label!=inputOrig.val()){btnEsborrar.click();}});function setInputLoading(setIt){inputOrig.removeClass('loading');if(setIt){inputOrig.addClass('loading');}}}catch(e){log.error("Error al crear l'autocomplete",e);}
return autoComplete||null;}
function InputSimple(opcions){try{opcions.mostraLabel=opcions.mostraLabel===false?false:true;if(!opcions.esborraTitle)opcions.esborraTitle=geoBCN.getLabel("input.esborrar").label;if(!opcions.desplegarTitle)opcions.desplegarTitle=geoBCN.getLabel("input.desplegar").label;opcions["input"]=jQuery("#"+opcions.inputId).wrapAll("<div class=\"frmInput\"></div>").before(opcions.mostraLabel?["<label for=\"",opcions.inputId,"\">",opcions.label,"</label>"].join(""):"").after(["<span id=\"err_",opcions.inputId,"\" class=\"errorInput\"></span>"].join(""));var inputOrig=jQuery("#"+opcions.inputId);var inputError=jQuery("#err_"+opcions.inputId);var inputSimple={"label":opcions.label,"setText":function(text){inputOrig.val(text);},"getText":function(){return inputOrig.val();},"setError":function(error){inputError.html(error);}}}catch(e){log.error("Error al crear l'input simple",e);}
return inputSimple||null;}
function InputCerca(opcions){var cercaHandlers=[];var esborraHandlers=[];try{opcions.mostraLabel=opcions.mostraLabel===false?false:true;if(!opcions.esborraTitle)opcions.esborraTitle=geoBCN.getLabel("input.esborrar").label;if(!opcions.cercaTitle)opcions.cercaTitle=geoBCN.getLabel("input.cercar").label;var inputOrig=jQuery("#"+opcions.inputId);inputOrig.wrapAll("<div class=\"frmInput\"></div>").before(opcions.mostraLabel?["<label for=\"",opcions.inputId,"\">",opcions.label,"</label>"].join(""):"").after(["<button type=\"BUTTON\" id=\"btnc_",opcions.inputId,"\" title=\"",opcions.cercaTitle,"\" class=\"ngac\"></button>","<button type=\"BUTTON\" id=\"btnd_",opcions.inputId,"\" title=\"",opcions.esborraTitle,"\" class=\"ngac\" style=\"display:none\"></button><span id=\"err_",opcions.inputId,"\" class=\"errorInput\"></span>"].join(""));var inputError=jQuery("#err_"+opcions.inputId);var btnCerca=jQuery("#btnc_"+opcions.inputId).button({text:false,icons:{primary:'ui-icon-search'}});var btnEsborrar=jQuery("#btnd_"+opcions.inputId).button({text:false,icons:{primary:'ui-icon-trash'}});function cridaHandlers(handlersArray){inputError.html("");for(var i=0,eventHandler;eventHandler=handlersArray[i];i++){window.setTimeout(function(obj){try{obj.handler(obj.params);}catch(err){log.warn("Error al cridar handler",err);}},5,{handler:eventHandler,params:inputOrig.val()});}}
var inputCerca={"label":opcions.label,"setText":function(text){inputOrig.val(text);},"getText":function(){return inputOrig.val();},"cerca":function(text){if(text)this.setText(text);cridaHandlers(cercaHandlers);btnEsborrar.fadeIn()},"setError":function(error){inputError.html(error);},"onCerca":function(handler){cercaHandlers.push(handler);},"onEsborra":function(handler){esborraHandlers.push(handler);},"esborra":function(){btnEsborrar.fadeOut();inputOrig.val("");cridaHandlers(esborraHandlers);}}
btnCerca.click(function(){inputCerca.cerca(inputOrig.val());});btnEsborrar.click(function(){inputCerca.esborra();});inputOrig.keypress(function(event){if(event.which==13){inputCerca.cerca(inputOrig.val());}});}catch(e){log.error("Error al crear l'InputCerca",e);}
return inputCerca||null;}
function creaAccordion(opcions){try{var panelCount=opcions.panells.length-1;var divPrincipal=jQuery("#"+opcions.divId);var htmlAccordion=["<div id=\"gcAccordion","_",opcions.divId,"\">"];for(var i=0,panell;panell=opcions.panells[i];i++){if(!panell.afegit){htmlAccordion.push("<h3>",panell.label,"</h3><div id=\"",opcions.divId,"_",panell.id,"\"></div>");panell.afegit=true;}}
htmlAccordion.push("</div>");divPrincipal.append(htmlAccordion.join(""));var divAccordion=jQuery(["#","gcAccordion","_",opcions.divId].join(""));var inputs=creaInputsAccordion(opcions);var jqAccordion=jQuery("#gcAccordion_"+opcions.divId).accordion({heightStyle:"content"});return{"inputs":inputs,"afegirPanell":function(opt){panelCount++;divAccordion.append(["<h3>",opt.label,"</h3><div id=\"",opcions.divId,"_",opt.id,"\">",opt.html?opt.html:"","</div>"].join(""));jqAccordion.accordion("refresh");var panell=jQuery(["#",opcions.divId,"_",opt.id].join(""));if(opt.dom)panell.append(opt.dom);log.debug("Afegim panell amb id "+panelCount);return{"idPanell":panelCount,"setContingut":function(opt){if(opt.html)panell.html(opt.html);if(opt.dom)panell.append(opt.dom);}}},"obrePanell":function(opt){jqAccordion.accordion({active:opt.idPanell});},"netejaInputs":function(){for(input in inputs){inputs[input].esborra();}}};}catch(e){log.error("Error al crear l'Accordion",e);}}
function creaInputsAccordion(opcions){var inputSelectCoordenades=null;var inputCarrer=null;var inputPortal=null;var inputCruilla=null;var inputDistricte=null;var inputBarri=null;var inputSecCens=null;var inputIlla=null;var inputFullsMil=null;var inputRefCat=null;var btnCentraCoords=null;var inputCoordX=null;var inputCoordY=null;var html=[];var marcador=null;try{if(opcions.cerques.indexOf("COORD")>=0){html.push("<input id=\"",opcions.divId,"_triaproj\" type=\"text\">","<input id=\"",opcions.divId,"_coordX\" type=\"text\">","<input id=\"",opcions.divId,"_coordY\" type=\"text\">","<button id=\"",opcions.divId,"_centraCoords\" type=\"text\" class=\"btnCerca\">",geoBCN.getLabel("input.cercar").label,"</button>");jQuery("#"+opcions.divId+"_gcCoordenades").html(html.join(""));inputSelectCoordenades=InputAutocomplete({"inputId":opcions.divId+"_triaproj","label":"Projecció","combobox":true,"origen":[{label:"ED50",value:"EPSG:23031",item:"EPSG:23031"},{label:"ETRS89",value:"EPSG:25831",item:"EPSG:25831"},{label:"WGS84",value:"EPSG:4326",item:"EPSG:4326"},{label:"TRESOR",value:"TRESOR",item:"TRESOR"}],"esborrat":function(){},"seleccio":function(){}});inputCoordX=new InputSimple({"inputId":opcions.divId+"_coordX","label":"X:"});inputCoordY=new InputSimple({"inputId":opcions.divId+"_coordY","label":"Y:"});var btnCentraCoords=jQuery("#"+opcions.divId+"_centraCoords").button({text:true,icons:{primary:'ui-icon-search'}});function centraCoordenades(){if(inputSelectCoordenades.getCodi()){if(validaCoord(inputCoordX)&&validaCoord(inputCoordY)){var localitzacio={"x":inputCoordX.getText().trim(),"y":inputCoordY.getText().trim(),"proj":inputSelectCoordenades.getCodi()};addMarcadorCercadors(localitzacio,["<h3>",geoBCN.getLabel("popup.cercaCoordenadesProj").label+" ",localitzacio.proj,"</h3>","<h3>X: ",localitzacio.x,"</h3>","<h3>Y: ",localitzacio.y,"</h3>"].join(""),5);}}else{inputSelectCoordenades.setError(geoBCN.getLabel("input.cercaCoordenadesErrorProj").label);}}
function validaCoord(input){if(!Utils.checkValorParametre(input.getText(),"[0-9]\\.?[0-9]?")){input.setError(geoBCN.getLabel("input.cercaCoordenadesErrorFormat").label);}else{return true;}}
btnCentraCoords.click(function(){centraCoordenades();})}
if(opcions.cerques.indexOf("ADR")>=0){html=[];html.push("<input id=\"",opcions.divId,"_carrer\" type=\"text\">","<input id=\"",opcions.divId,"_portal\" type=\"text\">");jQuery("#"+opcions.divId+"_gcAdreca").append(html.join(""));inputCarrer=InputAutocomplete({"inputId":opcions.divId+"_carrer","label":geoBCN.getLabel("input.carrer").label,"origen":function(request,response){geoBCN.Cercadors.cercaCarrers({"nom":inputCarrer.getText(),"resultat":function(data){response(jQuery.map(data.resultats,function(item){return{label:item["nom27"],value:item["codi"],item:item};}));}});},"esborrat":function(){},"seleccio":function(){}});inputPortal=InputAutocomplete({"inputId":opcions.divId+"_portal","label":geoBCN.getLabel("input.portal").label,"origen":function(request,response){geoBCN.Cercadors.cercaPortals({"id_via":inputCarrer.getCodi(),"numero":inputPortal.getText(),"resultat":function(data){response(jQuery.map(data.resultats,function(item){return{label:item["numeracioPostal"],value:item,item:item};}));}});},"master":inputCarrer,"masterRequired":true,"esborrat":function(){esborraMarcadorCercadors();},"seleccio":function(evt,item){addMarcadorCercadors(item.localitzacio,"<h3>"+item.nomComplet+"</h3>",5);}});}
if(opcions.cerques.indexOf("CRU")>=0){html=[];if(opcions.cerques.indexOf("ADR")<0)html.push("<input id=\"",opcions.divId,"_carrer\" type=\"text\">");html.push("<input id=\"",opcions.divId,"_cruilla\" type=\"text\">");jQuery("#"+opcions.divId+"_gcAdreca").append(html.join(""));if(opcions.cerques.indexOf("ADR")<0)inputCarrer=InputAutocomplete({"inputId":opcions.divId+"_carrer","label":geoBCN.getLabel("input.carrer").label,"origen":function(request,response){geoBCN.Cercadors.cercaCarrers({"nom":inputCarrer.getText(),"resultat":function(data){response(jQuery.map(data.resultats,function(item){return{label:item["nom18"],value:item["codi"],item:item};}));}});},"esborrat":function(){},"seleccio":function(){}});inputCruilla=InputAutocomplete({"inputId":opcions.divId+"_cruilla","label":geoBCN.getLabel("input.cruilla").label,"master":inputCarrer,"masterRequired":true,"combobox":true,"origen":function(request,response){geoBCN.Cercadors.cercaCruilles({"id_via":inputCarrer.getCodi(),"nom":inputCruilla.getText(),"resultat":function(data){response(jQuery.map(data.resultats,function(item){var textItem=item.via2["nom18"];if(item["posicioRelativa"]){textItem+=item["posicioRelativa"]=='C'?'':' ('+item["posicioRelativa"]+')';}
return{label:textItem,value:item,item:item};}));}});},"esborrat":function(){esborraMarcadorCercadors();},"seleccio":function(evt,item){addMarcadorCercadors(item.localitzacio,"<h3>"+item.via2.tipusViaAbr+item.via2.nomComplet+"</h3>",5);}});}
if(opcions.cerques.indexOf("ILLA")>=0){html=["<input id=\"",opcions.divId,"_illa\" type=\"text\">"];jQuery("#"+opcions.divId+"_gcIdentificador").append(html.join(""));inputIlla=new InputCerca({"inputId":opcions.divId+"_illa","label":geoBCN.getLabel("input.illa").label});inputIlla.onCerca(function(valor){inputIlla.setError("");geoBCN.Cercadors.cercaIlles({"codi":valor,"resultat":function(data){if(data.resultats.length){addMarcadorCercadors(data.resultats[0].localitzacio,"<h3>"+data.resultats[0].codi+"</h3>",5);}else{inputIlla.setError(geoBCN.getLabel("error.senseResultats").label);}}});});inputIlla.onEsborra(function(){esborraMarcadorCercadors();});}
if(opcions.cerques.indexOf("RC")>=0){html=["<input id=\"",opcions.divId,"_refcat\" type=\"text\">"];jQuery("#"+opcions.divId+"_gcIdentificador").append(html.join(""));inputRefCat=new InputCerca({"inputId":opcions.divId+"_refcat","label":geoBCN.getLabel("input.refcadastral").label});inputRefCat.onCerca(function(valor){geoBCN.Cercadors.cercaRefCatPar({"rc":valor,"resultat":function(data){if(data.resultats.length){addMarcadorCercadors(data.resultats[0].localitzacio,"<h3>"+data.resultats[0].referenciaCadastral+"</h3>",5);}else{inputIlla.setError(geoBCN.getLabel("error.senseResultats").label);}}});});inputRefCat.onEsborra(function(){esborraMarcadorCercadors();});}
if(opcions.cerques.indexOf("F1000")>=0){html=["<input id=\"",opcions.divId,"_f1000\" type=\"text\">"];jQuery("#"+opcions.divId+"_gcIdentificador").append(html.join(""));inputFullsMil=new InputCerca({"inputId":opcions.divId+"_f1000","label":geoBCN.getLabel("input.cercafulls").label});inputFullsMil.onCerca(function(valor){geoBCN.Cercadors.cercaFullsMil({"codi":valor,"resultat":function(data){if(data.resultats.length){addMarcadorCercadors(data.resultats[0].localitzacio,"<h3>"+data.resultats[0].codi+"</h3>",5);}else{inputFullsMil.setError(geoBCN.getLabel("error.senseResultats").label);}}});});inputFullsMil.onEsborra(function(){esborraMarcadorCercadors();});}
if(opcions.cerques.indexOf("DST")>=0){html=["<input id=\"",opcions.divId,"_districte\" type=\"text\">"];jQuery("#"+opcions.divId+"_gcDivAdm").append(html.join(""));inputDistricte=InputAutocomplete({"inputId":opcions.divId+"_districte","label":geoBCN.getLabel("input.cercaDistrictes").label,"combobox":true,"origen":function(request,response){geoBCN.Cercadors.cercaDistrictes({"nom":inputDistricte.getText(),"resultat":function(data){response(jQuery.map(data.resultats,function(item){return{label:item["descripcio"],value:item,item:item};}));}});},"esborrat":function(){esborraMarcadorCercadors();},"seleccio":function(evt,item){addMarcadorCercadors(item.localitzacio,"<h3>"+item.descripcio+"</h3>",5);}});}
if(opcions.cerques.indexOf("BRR")>=0){html=[];html.push("<input id=\"",opcions.divId,"_barri\" type=\"text\">");jQuery("#"+opcions.divId+"_gcDivAdm").append(html.join(""));inputBarri=InputAutocomplete({"inputId":opcions.divId+"_barri","label":geoBCN.getLabel("input.barri").label,"combobox":true,"origen":function(request,response){geoBCN.Cercadors.cercaBarris({"nom":inputBarri.getText(),"resultat":function(data){response(jQuery.map(data.resultats,function(item){return{label:item["nom"],value:item,item:item};}));}});},"esborrat":function(){esborraMarcadorCercadors();},"seleccio":function(evt,item){addMarcadorCercadors(item.localitzacio,"<h3>"+item.nom+"</h3>",5);}});}
if(opcions.cerques.indexOf("SECC")>=0){html=[];html.push("<input id=\"",opcions.divId,"_seccens\" type=\"text\">");jQuery("#"+opcions.divId+"_gcDivAdm").append(html.join(""));inputSecCens=InputAutocomplete({"inputId":opcions.divId+"_seccens","label":geoBCN.getLabel("input.seccioCensal").label,"origen":function(request,response){marcador=geoBCN.Cercadors.cercaSecCensal({"codi":inputSecCens.getText(),"resultat":function(data){response(jQuery.map(data.resultats,function(item){return{label:"Dist:"+item["districteId"]+" Sec:"+item["codi"],value:item,item:item};}));}});},"esborrat":function(){esborraMarcadorCercadors();},"seleccio":function(evt,item){addMarcadorCercadors(item.localitzacio,"<h3>"+item.id+"</h3>",5);}});}
return{"SelectCoordenades":inputSelectCoordenades,"Carrer":inputCarrer,"Portal":inputPortal,"Illa":inputIlla,"RC":inputRefCat,"FullsMil":inputFullsMil,"Cruilla":inputCruilla,"Districte":inputDistricte,"Barri":inputBarri,"SecCens":inputSecCens,"CercaCoords":btnCentraCoords};}catch(e){log.error("Error al crear els Inputs de l'accordion",e);}
function addMarcadorCercadors(localitzacio,htmlPopup,zoom){if(opcions.mapa){esborraMarcadorCercadors();marcador=opcions.mapa.afegeixMarcador({"localitzacio":localitzacio,"popup":{html:htmlPopup}});opcions.mapa.centraMapa({"localitzacio":localitzacio,"zoom":zoom});}}
function esborraMarcadorCercadors(){try{if(marcador&&opcions.mapa){opcions.mapa.amagaPopup();opcions.mapa.esborraMarcador(marcador);}}catch(e){log.warn("No s'ha pogut esborrar el marcador");}finally{marcador=null;}}}
return{themes:['barcelona','bermuda','crimson'],Cercadors:function(opcions){if(!opcions.theme)opcions.theme='barcelona';Utils.loadCSS("js/lib/jquery/ui-1.10.4/themes/"+opcions.theme+"/jquery-ui-"+geoBCN.versions["ui"]+".custom.css","geobcn","geobcn");log.debug("creant cercadors");try{opcions.panells=[];for(tipusCerca in opcions.cerques){for(var i=0,panell;panell=panellsCerca[i];i++){if(panell.inputs.indexOf(opcions.cerques[tipusCerca])>=0&&!panellsCerca[i].added){panellsCerca[i].added=true;opcions.panells.push(panell);break;}}}
return creaAccordion(opcions);}catch(e){log.error("Error al crear els Cercadors",e);}},InputCerca:function(opcions){try{return InputCerca(opcions);}catch(e){log.error("Error al crear l'InputCerca",e);}},InputSimple:function(opcions){try{return InputSimple(opcions);}catch(e){log.error("Error en crear un InputSimple",e);}},InputAutocomplete:function(opcions){try{if(!opcions.theme)opcions.theme='barcelona';Utils.loadCSS("js/lib/jquery/ui-1.10.4/themes/"+opcions.theme+"/jquery-ui-"+geoBCN.versions["ui"]+".custom.css","geobcn","geobcn");var paramsRequerits={"inputId":{"regexp":"\\S"},"label":{"regexp":"\\S"},"origen":{"typeof":"function"}};if(Utils.checkParametres(opcions,paramsRequerits)){return InputAutocomplete(opcions);}else{throw"Paràmetres incorrectes";}}catch(e){log.error("Error en InputAutocomplete",e);}},setTheme:function(opcions){if(Utils.checkValorParametre(opcions.theme,"^barcelona$|^bermuda$|^crimson$")){Utils.loadCSS(["js/lib/jquery/ui-1.10.4/themes/",opcions.theme,"/jquery-ui-",geoBCN.versions["ui"],".custom.css"].join(""),"geobcn","geobcn",true);}else{throw"Paràmetres incorrectes. Falta paràmetre theme o theme no suportat";}}};});